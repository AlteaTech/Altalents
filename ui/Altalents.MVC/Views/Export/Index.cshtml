@{
    ViewData["Title"] = "Exporter les marques";
    Layout = "_LayoutAdmin";
}

<script>
    function actionConfirmationExport(callbackFinalize) {
        $.ajax({
            url: '@Url.Action("Exporter", ExportController.ControllerName)',
            type: "GET",
            success: function (recdata)
            {
                var data = decodeURIComponent(escape(window.atob(recdata)))
                const blob = new Blob([data], { type: "text/csv" });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a')
                a.setAttribute('href', url)
                a.setAttribute('download', 'collectie.csv');
                a.click()
                showNotification('@LibellesResources.ExportReussi', 'success');
            },
            error: erreurFunction,
            finalize: function () {
                callbackFinalize();
            }
        });
    }

    function actionNonConfirmationExport(callbackFinalize) {
        callbackFinalize();
    }

    function onExporterClick() {
        var functionOnConfirmation = function (callbackFinalize) {
            actionConfirmationExport(callbackFinalize);
        }
        openConfirmationExportDialog(functionOnConfirmation, actionNonConfirmationExport);
    }
</script>

@(Html.Kendo().Button().CreateDefautButton("Export", LibellesResources.CommunBtnExporter, "onExporterClick", themeColor: ThemeColor.Primary))
